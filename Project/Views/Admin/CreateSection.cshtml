@model Project.Models.Section

@{
    var batches = ViewBag.Batches as List<Project.Models.Batch> ?? new List<Project.Models.Batch>();
    var modelErrors = TempData["ModelErrors"] as string;
}

<div class="d-flex justify-content-between align-items-center">
    <h1>Create Section</h1>
    <div>
        <a class="btn btn-secondary me-2" href="@Url.Action("Sections", "Admin")">Back</a>
    </div>
</div>

@if (!string.IsNullOrEmpty(modelErrors))
{
    <div class="alert alert-warning">@modelErrors</div>
}

<form asp-action="CreateSection" asp-controller="Admin" method="post" class="mt-3">
    @Html.AntiForgeryToken()
    @Html.ValidationSummary(true, "", new { @class = "text-danger" })

    <div class="mb-3">
        <label for="Name" class="form-label">Name</label>
        <input asp-for="Name" id="Name" name="Name" class="form-control" required />
        <span asp-validation-for="Name" class="text-danger"></span>
    </div>
    <div class="mb-3">
        <label for="BatchId" class="form-label">Batch</label>
        <select asp-for="BatchId" class="form-control" id="BatchId" name="BatchId" required>
            <option value="">-- Select batch --</option>
            @foreach (var b in batches)
            {
                <option value="@b.Id" selected="@(Model != null && Model.BatchId == b.Id ? "selected" : null)">@b.Name @(!string.IsNullOrEmpty(b.Session) ? "(" + b.Session + ")" : "")</option>
            }
        </select>
        <span asp-validation-for="BatchId" class="text-danger"></span>
    </div>

    <button type="submit" class="btn btn-success" @(batches.Any() ? "" : "disabled")>Create Section</button>
</form>

@if (Model != null)
{
    <div class="mt-3">
        <h5>Posted values (debug)</h5>
        <ul>
            <li>Name: @Model.Name</li>
            <li>BatchId: @Model.BatchId</li>
        </ul>
    </div>
}

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
}